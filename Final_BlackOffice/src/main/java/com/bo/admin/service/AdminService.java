package com.bo.admin.service;

import java.util.HashMap;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Isolation;
import org.springframework.transaction.annotation.Propagation;
import org.springframework.transaction.annotation.Transactional;

import com.bo.admin.model.AdressbookVO;
import com.bo.admin.model.InterAdminDAO;
import com.bo.common.AES256;
import com.bo.member.model.MemberVO;


//=== Service 선언 ===
@Service 
public class AdminService implements InterAdminService{
	
	/* 관리자 메뉴 관련 서비스  2020/01/15 LBH */
	
	// === 의존객체 주입하기(DI: Dependency Injection) ===
	@Autowired   // Type에 따라 알아서 Bean 을 주입해준다.
	private InterAdminDAO dao;
	
	// === #45. 양방향 암호화 알고리즘인 AES256를 사용하여 암호화/복호화 하기위한 클래스 의존객체 주입하기 (DI: Dependency Injection)
	@Autowired
	private AES256 aes;
	
	//////////////////////////////////////////////////////////////////////////////////////////////////////
	//////////////////////////////////////////////////////////////////////////////////////////////////////			[ 로그인 ]
	//////////////////////////////////////////////////////////////////////////////////////////////////////
	
	// 로그인 시도
	@Override
	public MemberVO getLoginMember(HashMap<String, String> paraMap) {
		MemberVO loginuser =  dao.getLoginMember(paraMap);
		return loginuser;
	}
	
	//////////////////////////////////////////////////////////////////////////////////////////////////////
	//////////////////////////////////////////////////////////////////////////////////////////////////////			[ 통계(차트) ]
	//////////////////////////////////////////////////////////////////////////////////////////////////////
	
	
	
	//////////////////////////////////////////////////////////////////////////////////////////////////////
	//////////////////////////////////////////////////////////////////////////////////////////////////////			[ 입사처리/인사 ]
	//////////////////////////////////////////////////////////////////////////////////////////////////////
	
	//신규 입사 등록 2020/01/15 LBH
	@Override
	@Transactional(propagation=Propagation.REQUIRED, isolation= Isolation.READ_COMMITTED, rollbackFor={Throwable.class})
	public int register(MemberVO mvo, AdressbookVO adressbookvo) {
		
		int register = dao.register(mvo);
		
		String positionname = dao.getPositionname(mvo.getFk_positionno());
		String departmentname = dao.getDepartmentname(mvo.getFk_departmentno());
		
		adressbookvo.setPositionname(positionname);
		adressbookvo.setDepartmentname(departmentname);
		
		System.out.println("positionname: " + positionname + ", departmentname: " + departmentname);
		
		register = dao.adressRegister(adressbookvo);
		return register;
	}
	
	//////////////////////////////////////////////////////////////////////////////////////////////////////
	//////////////////////////////////////////////////////////////////////////////////////////////////////			[ 주소록 ( 개인 / 공용 ) ]
	//////////////////////////////////////////////////////////////////////////////////////////////////////
	
	// 개인주소록 추가등록 2020/01/16 LBH 
	@Override
	public int registerPersonal(AdressbookVO abvo) {
		int registerPersonal = dao.registerPersonal(abvo);
		return registerPersonal;
	}

	//////////////////////////////////////////////////////////////////////////////////////////////////////
	//////////////////////////////////////////////////////////////////////////////////////////////////////
	//////////////////////////////////////////////////////////////////////////////////////////////////////
	
	
	
	
	

	
}
